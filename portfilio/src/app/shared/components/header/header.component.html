<header class="app-header">

  @if (isProfileMenuOpen) {
    <div class="click-overlay" (click)="closeMenu()"></div>
  }

  <div class="header-left">
    <a [routerLink]="variant === 'auth' ? '/' : '/home'" class="logo-link">
      <img src="assets/images/logo_application.png" alt="Logo FIL" class="logo-img" />
    </a>
  </div>

  @if (variant === 'detail') {
    <div class="header-center">
      <button class="back-btn" (click)="goBack()">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 18l-6-6 6-6"/></svg>
      </button>
      <h1 class="project-title">{{ projectTitle }}</h1>
    </div>
  }

  @if (variant !== 'auth') {
    <nav class="header-right">

      <button class="icon-btn create-btn" (click)="handleAction('/create-project')" aria-label="Créer un projet">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="16"></line><line x1="8" y1="12" x2="16" y2="12"></line></svg>
      </button>

      <button class="icon-btn favorite-btn" (click)="handleAction('/favorites')" aria-label="Mes favoris">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="feather feather-heart"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>
      </button>

      <div class="profile-container">

        <button
          class="icon-btn profile-btn"
          [class.active]="isProfileMenuOpen"
          (click)="handleProfileClick()"
          aria-label="Mon profil">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
        </button>

        @if (isProfileMenuOpen) {
          <div class="profile-dropdown">

            <button class="dropdown-item" (click)="handleAction('/profile'); closeMenu()">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
              Mon profil
            </button>

            <div class="divider"></div>

            <button class="dropdown-item logout" (click)="onLogout()">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>
              Se déconnecter
            </button>

          </div>
        }

      </div>

    </nav>
  }
</header>
